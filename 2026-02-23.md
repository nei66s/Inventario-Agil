# Resumo de Alterações e Commits - 23 de Fevereiro de 2026

## Documentação de Commits

### 1. feat: mount realtime listener in authenticated layout (`a037fef`)
- **Arquivos Modificados:** `layout.tsx` (dashboard, inventory, orders, production)
- **Descrição:** Inclusão do componente `RealtimeListener` nos layouts autenticados das principais rotas do sistema. Isso garante a inicialização da conexão WebSocket e o escuta global de eventos em tempo real, sem redundâncias ou vazamento de estado.

### 2. feat: add realtime mount debug log (`fa4a4da`)
- **Arquivos Modificados:** `src/hooks/useRealtime.ts`
- **Descrição:** Adição de log de debug (`console.log`) temporário na montagem do hook para facilitar o monitoramento e verificação da inicialização do WebSocket no lado do cliente.

### 3. chore: fix build errors and finalize realtime implementation (`6cbb8b6`)
- **Arquivos Modificados:** 38 arquivos (incluindo rotas da API, páginas do dashboard/estoque, scripts de migração `.sql` e repositórios)
- **Descrição:** Commit robusto que consolidou múltiplas melhorias e finalizações do dia:
  - **Tempo Real & Pub/Sub:** Finalização da arquitetura e do mecanismo de publicação/consumo de eventos em tempo real via Redis (`pubsub.ts` e hook funcional `useRealtime.ts`).
  - **Correção de Build e Tipagem:** Resolução de erros no ESLint, adição de escape adequado em strings e fechamento do `useSearchParams` com `Suspense` limits.
  - **Histórico e Atividade Operacional:** Criação do script de banco de dados (`migrations/036_...`) para registro e consumo de logs de atividades de indivíduos e indicadores (`people_activity_log`, `logActivity`).
  - **Banco de Dados (Fix):** Atualização rigorosa do pool de conexões do PgBouncer em Serverless, removendo lógica legada de "warm-up" e estabelecendo validações mais seguras de tags/cache de Redis para evitar snapshots defasados.
  - **UX/UI Estendida:** Renomeação da sidebar de Logística/Inventário para torná-la menos poluída, e correção da lógica em que os ajustes de estoque frequentemente zerevam quantidades de modo equivocado. Melhoria no fluxo de produção para concluir tarefas em uma única tela.

### 4. Optimize Login Shell performance for better FID (`8a91ae2`)
- **Arquivos Modificados:** `src/app/layout.tsx`, `src/app/login/login-shell.tsx`, `site-settings.ts`, `tailwind.config.ts`
- **Descrição:** Otimização voltada para performance e First Input Delay (FID) na Shell principal de autenticação e layout raiz.

### 5. Fix dashboard status overlap and MRP order visibility (`471333a`)
- **Arquivos Modificados:** `src/app/api/orders/route.ts`, `client-dashboard.tsx`, `inventory/page.tsx`
- **Descrição:** Foco na exibição de dados e correção de CSS das views principais:
  - **Visibilidade de Pedidos MRP:** Correção do problema onde pedidos que estavam na fase de "em separação" (separação) simplesmente sumiam da visualização principal.
  - **UI (Overlap CSS):** Limpeza e reajuste sobre os seletores de CSS causando quebra e sobreposição dos indicadores visuais nas métricas do Dashboard.

---

## Principais Frentes Impactadas Hoje

1. **Infraestrutura Real-time**: A aplicação evoluiu para suportar transações ativas via WebSocket / Redis Pub-Sub, possibilitando a atualização automática das telas operacionais de inventário e dashboard para centenas de usuários concorrentes em Vercel.
2. **Confiabilidade Serverless**: Configurações de pool em `db.ts` atualizadas para Next.js / PgBouncer, extirpando sobrecargas assíncronas em cache tagging (revalidation failures ou race-conditions).
3. **Usabilidade Operacional & Workflow**: Correções massivas no input de operadores (ex: evitar múltiplos disparos no `onChange` ao ajustar estoque), consolidação dos layouts MRP e simplificação visual da aba de "Logística" na sidebar.
